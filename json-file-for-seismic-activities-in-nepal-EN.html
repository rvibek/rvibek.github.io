<!DOCTYPE html>
<html lang="EN">
  <head>
        <title>rvibek - JSON file for seismic activities in Nepal</title>
      <meta charset="utf-8" />
      <meta name="generator" content="Pelican" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="..in the making" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="rvibek Full Atom Feed" />
        <link href="/feeds/blog.atom.xml" type="application/atom+xml" rel="alternate" title="rvibek Categories Atom Feed" />




    <meta name="tags" content="python" />
    <meta name="tags" content="scraping" />
    <meta name="tags" content="data" />
    <meta name="tags" content="earthquake" />
    <meta name="tags" content="json" />
    <meta name="tags" content="magazine" />

  </head>

  <body>
      <header>
          <hgroup><h1><a href="/">rvibek</a></h1><p>..in the making</p></hgroup>
          <nav><ul>
              <li><a href="https://rvibek.com.np">Home</a></li>
              <li><a href="https://rvibek.com.np/authors.html">About</a></li>
                <li><a href="/category/blog.html"  aria-current="page" >Blog</a></li>
          </ul></nav>
      </header>
      <main>
  <article>
    <header>
      <h2>
        <a href="/json-file-for-seismic-activities-in-nepal-EN.html" rel="bookmark"
           title="Permalink to JSON file for seismic activities in Nepal">JSON file for seismic activities in Nepal</a></h2>
      
    </header>
    <p>Spent the long weekend fiddling with <a href="http://cran.r-project.org/" title="target&quot;=_blank">R</a> and <a href="http://python.org&quot; target&quot;=_blank">Python</a> mainly to pull the data - and then cleaning and reorganising.</p>
<p>Among others, I wrote a python script to reorganise the table containing seismological record from <a href="http://seismonepal.gov.np" title="target=&quot;_blank">seismonepal.gov.np</a> website.</p>
<p><strong>=ImportHTML()</strong> is a handy function to fetch the data from a table or list. It time saver trick in <a href="http://spreadsheet.google.com" title="target=&quot;_blank">Google Spreadsheet</a> when the source data is available in a tabular or list form. </p>
<div class="highlight"><pre><span></span><code><span class="o">=</span><span class="n">ImportHTML</span><span class="p">(</span><span class="s2">&quot;http://seismonepal.gov.np/index.php&quot;</span><span class="p">,</span> <span class="s2">&quot;table&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<p>Next, a python script converts data in English into Nepal</p>
<div class="highlight"><pre><span></span><code><span class="c1">#List of character/word to be replaced</span>
<span class="n">replaceDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;1&#39;</span><span class="p">:</span><span class="s1">&#39;१&#39;</span> <span class="p">,</span>
    <span class="s1">&#39;2&#39;</span><span class="p">:</span><span class="s1">&#39;२&#39;</span> <span class="p">,</span>
    <span class="s1">&#39;3&#39;</span><span class="p">:</span><span class="s1">&#39;३&#39;</span> <span class="p">,</span>
    <span class="s1">&#39;Local Time&#39;</span> <span class="p">:</span> <span class="s1">&#39;LocalTime&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Magnitude(ML)&#39;</span> <span class="p">:</span> <span class="s1">&#39;Magnitude&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Achham&#39;</span> <span class="p">:</span> <span class="s1">&#39;अछाम&#39;</span>   <span class="p">,</span>
    <span class="s1">&#39;Arghakhanchi&#39;</span> <span class="p">:</span> <span class="s1">&#39;अर्घाखाँची&#39;</span>   <span class="p">,</span>
    <span class="s1">&#39;Baglung&#39;</span> <span class="p">:</span> <span class="s1">&#39;बाग्लुङ&#39;</span>   
    <span class="p">}</span>

 <span class="c1">#Function to replace word </span>
 <span class="k">def</span> <span class="nf">replace_all</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">dic</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>

 <span class="c1">#Iteration</span>
 <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;earthquake.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
    <span class="n">earthquake</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">record2read</span><span class="p">):</span>

        <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">earthquake</span><span class="o">.</span><span class="n">next</span><span class="p">()]</span>
        <span class="n">row</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">replace_all</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">replaceDict</span><span class="p">)</span>
</code></pre></div>

<p>And writing the result into <a href="http://app-weather.rhcloud.com/data/earthquake/earthquake.json" title="target=&quot;_blank">JSON</a> format with Nepali data. </p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;earthquake&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="s2">&quot;MM&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;५&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;DD&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;१७&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Longitude&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;८५.८७&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Epicentre&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;रामेछाप&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Magnitude&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;४.६&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;YYYY&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;२०१५&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Remarks&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;NSC&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Date&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;१७/०५/२०१५&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Latitude&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;२७.४८&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;LocalTime&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;११:३०&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="s2">&quot;MM&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;५&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;DD&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;१७&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Longitude&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;८६.०६&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Epicentre&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;दोलखा&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Magnitude&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;४.४&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;YYYY&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;२०१५&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Remarks&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;NSC&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Date&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;१७/०५/२०१५&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Latitude&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;२७.७३&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;LocalTime&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;०५:००&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="s2">&quot;MM&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;५&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;DD&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;१६&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Longitude&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;८६.१४&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Epicentre&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;दोलखा&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Magnitude&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;४.३&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;YYYY&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;२०१५&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Remarks&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;NSC&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Date&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;१६/०५/२०१५&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Latitude&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;२७.६४&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;LocalTime&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;२०:४४&quot;</span>
<span class="w">        </span><span class="p">}]}</span>
</code></pre></div>

<p>Finally - widget based on above JSON file. <a href="http://himalkhabar.com" title="target=&quot;_blank">HimalKhabar</a> has embedded it in its website.</p>
<p><img alt="Seismic Activity Card" src="https://res.cloudinary.com/rvibek-com-np/image/upload/w_350,e_shadow/v1628804084/reu56ezdegh7pkymfg9w.png"></p>
<blockquote class="twitter-tweet" lang="en"><p lang="ne" dir="ltr">भूकम्पको लाइभ अपडेट <a href="http://t.co/yfbJgjRYxA">http://t.co/yfbJgjRYxA</a> मा ।</p>&mdash; Himal Khabar (@Himal_Khabar) <a href="https://twitter.com/Himal_Khabar/status/600229390790721538">May 18, 2015</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
    <footer>
      <p>Published: <time datetime="2015-05-18T13:08:43+02:00">
        May 18, 2015
      </time></p>
        <p>Last updated: <time datetime="2015-05-18T14:08:43+02:00">
          May 18, 2015
        </time></p>
        <address>
          By             <a href="/author/vibek-raj-maurya.html">Vibek Raj Maurya</a>
        </address>
        <p>
          Category: <a href="/category/blog.html">Blog</a>
        </p>
        <p>
          Tags:
            <a href="/tag/python.html">python</a>
            <a href="/tag/scraping.html">scraping</a>
            <a href="/tag/data.html">data</a>
            <a href="/tag/earthquake.html">earthquake</a>
            <a href="/tag/json.html">json</a>
            <a href="/tag/magazine.html">magazine</a>
        </p>
    </footer>
  </article>
      </main>
      <footer>
          <address>
            Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>,
            which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
          </address>
      </footer>
  </body>
</html>